parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"LN/f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={createStyleSheet:function(e){if(!document.getElementById("gameStyleSheet")){var t=document.createElement("style");t.type="text/css",t.id="gameStyleSheet",t.innerHTML=e,document.head.appendChild(t)}},createCanvas:function(e){e=e||document.body;var t=document.createElement("div"),n=document.createElement("canvas");return t.className="game-wrapper",n.className="game-ui",t.appendChild(n),e.appendChild(t),{wrapper:t,canvas:n}},getPixRatio:function(e){var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||1;return(window.devicePixelRatio||1)/t},isFunc:function(e){return"function"==typeof e},getRndInt:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},imageLoad:function(e){return new Promise(function(t,n){var a=new Image;a.onload=function(){a.onload=null,t(a)},a.onerror=function(e){a.onerror=null,n(new Error("图片加载失败"))},a.src=e})}},t=e;exports.default=t;
},{}],"epB2":[function(require,module,exports) {
"use strict";var t=e(require("../utils"));function e(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}var a=function(){function e(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.callbacks=o;var a=t.default.createCanvas(n),r=a.wrapper,c=a.canvas;this.wrapper=r,this.canvas=c,this.context=this.canvas.getContext("2d"),this.pixRatio=t.default.getPixRatio(this.context),this.canvas.addEventListener("click",this.onClick.bind(this))}return o(e,[{key:"onClick",value:function(e){var i=this,n=this.callbacks.onDone,o=this.getCurBlock(e);o&&this.canMove(o)&&this.moveBlock(o).then(function(){i.checkDone()&&t.default.isFunc(n)&&n()})}},{key:"getCurBlock",value:function(t){var e=(t.offsetX||t.pageX)*this.pixRatio,i=(t.offsetY||t.pageY)*this.pixRatio;return this.blocks.find(function(t){return t.x<e&&e<t.x+t.w&&t.y<i&&i<t.y+t.h})}},{key:"canMove",value:function(t){var e=this.blockSpace,i=this.emptyBlock,n=i.x,o=i.y,a=i.w,r=i.h;return t.x===n&&Math.abs(t.y-o)<=r+2*e||t.y===o&&Math.abs(t.x-n)<=a+2*e}},{key:"moveBlock",value:function(t){var e=t.x,i=t.y,n=this.emptyBlock.x,o=this.emptyBlock.y,a=Math.floor(this[e===n?"bh":"bw"]/10);return this[e===n?i>o?"moveUp":"moveDown":e>n?"moveLeft":"moveRight"](t,this.emptyBlock,a)}},{key:"moveUp",value:function(t,e,i){var n=this,o=t.y;return new Promise(function(a){!function r(){n.frameNum=window.requestAnimationFrame(r),t.y-=i,t.y<=e.y&&(window.cancelAnimationFrame(n.frameNum),t.y=e.y,e.y=o,a()),n.drawBlocks()}()})}},{key:"moveRight",value:function(t,e,i){var n=this,o=t.x;return new Promise(function(a){!function r(){n.frameNum=window.requestAnimationFrame(r),t.x+=i,t.x>=e.x&&(window.cancelAnimationFrame(n.frameNum),t.x=e.x,e.x=o,a()),n.drawBlocks()}()})}},{key:"moveDown",value:function(t,e,i){var n=this,o=t.y;return new Promise(function(a){!function r(){n.frameNum=window.requestAnimationFrame(r),t.y+=i,t.y>=e.y&&(window.cancelAnimationFrame(n.frameNum),t.y=e.y,e.y=o,a()),n.drawBlocks()}()})}},{key:"moveLeft",value:function(t,e,i){var n=this,o=t.x;return new Promise(function(a){!function r(){n.frameNum=window.requestAnimationFrame(r),t.x-=i,t.x<=e.x&&(window.cancelAnimationFrame(n.frameNum),t.x=e.x,e.x=o,a()),n.drawBlocks()}()})}},{key:"checkDone",value:function(){var t=this;return this.blocks.every(function(e,i){var n=t.bakBlocks[i];return n.x===e.x&&n.y===e.y})}},{key:"initUI",value:function(e){var i=this,n=e.rows,o=e.cols,a=e.src;this.rows=n||o,this.cols=o,this.blockSpace=this.pixRatio,this.updateSize(),t.default.imageLoad(a).then(function(t){i.img=t;var e=i.genBlocks(),n=e.blocks,o=e.bakBlocks,a=e.emptyBlock;i.blocks=n,i.bakBlocks=o,i.emptyBlock=a,i.drawBlocks()})}},{key:"updateSize",value:function(){var t=this.canvas.offsetWidth;this.width=this.canvas.width=this.canvas.height=t*this.pixRatio,this.bw=(this.width-this.blockSpace*(this.cols+1))/this.cols,this.bh=(this.width-this.blockSpace*(this.rows+1))/this.rows}},{key:"genBlocks",value:function(){for(var e=this.img,i=this.rows,n=this.cols,o=this.bw,a=this.bh,r=this.blockSpace,c=[],s=e.naturalWidth/n,u=e.naturalHeight/i,h=0;h<i;h++)for(var l=0;l<n;l++){var f=(o+r)*l+r,m=(a+r)*h+r;c.push({ix:s*l,iy:u*h,iw:s,ih:u,x:f,y:m,w:o,h:a})}var v=[0,n-1,n*(i-1),i*(n-1)][t.default.getRndInt(0,3)];return{emptyBlock:c.splice(v,1)[0],bakBlocks:c,blocks:this.createRndBlocks(c)}}},{key:"createRndBlocks",value:function(t){var e=t.map(function(t){return{x:t.x,y:t.y}});e.sort(function(){return Math.random()-.5});var i=JSON.parse(JSON.stringify(t));return i.forEach(function(t,i){t.x=e[i].x,t.y=e[i].y}),i}},{key:"drawBlocks",value:function(){var t=this.context,e=this.img,i=this.width,n=this.blocks;t.clearRect(0,0,i,i),n.forEach(function(i){var n=i.ix,o=i.iy,a=i.iw,r=i.ih,c=i.x,s=i.y,u=i.w,h=i.h;t.drawImage(e,n,o,a,r,c,s,u,h)})}}]),e}(),r={cols:3,src:document.getElementById("gameImage").src},c=new a(document.querySelector(".game-container"),{onDone:function(){confirm("恭喜！你完成了！要体验更高难度的吗？")&&(r.cols+=1),c.initUI(r)}});c.initUI(r);
},{"../utils":"LN/f"}]},{},["epB2"], null)